name: Auto Assign Reviewer

on:
  pull_request:
    types: [opened]

jobs:
  assign-reviewer:
    runs-on: ubuntu-latest
    steps:
      - name: Auto assign reviewer
        uses: actions/github-script@v7
        with:
          script: |
            const { owner, repo } = context.repo;
            const prNumber = context.payload.pull_request.number;
            
            // Assign yourself as reviewer
            await github.rest.pulls.requestReviewers({
              owner,
              repo,
              pull_number: prNumber,
              reviewers: ['swarnavacodes']
            });
            
            // Add labels to the PR
            await github.rest.issues.addLabels({
              owner,
              repo,
              issue_number: prNumber,
              labels: ['ğŸ¤– ai-review', 'ğŸ‘€ needs-review']
            });
            
            // Add a comment explaining the AI reviewer
            await github.rest.issues.createComment({
              owner,
              repo,
              issue_number: prNumber,
              body: `## ğŸ¤– AI Code Reviewer Activated
              
**Human Reviewer**: @swarnavacodes has been automatically assigned

**AI Reviewer**: The Gemini AI Code Reviewer is now analyzing this PR and will post a detailed review comment within 2-3 minutes.

### ğŸ“Š What the AI will analyze:
- ğŸ›¡ï¸ **Security vulnerabilities** (SQL injection, hardcoded secrets, etc.)
- âš¡ **Performance issues** (inefficient algorithms, memory leaks)
- ğŸ“ **Code quality** (best practices, error handling, documentation)
- ğŸ¯ **Custom team rules** (41+ rules configured)

### ğŸ“„ Reports will be generated:
- ğŸ’¬ **Enhanced PR comment** with detailed analysis
- ğŸ“Š **JSON report** for programmatic access
- ğŸŒ **HTML report** for visual review
- ğŸ“ **Downloadable artifacts** in Actions tab

**â±ï¸ Expected completion**: 2-3 minutes

---
*This comment was automatically generated. The AI review will appear as a separate comment below.*`
            });
            
            console.log('âœ… Reviewer assigned and AI explanation posted');